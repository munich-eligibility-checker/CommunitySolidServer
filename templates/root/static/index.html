<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>M-Pod Server</title>
  <link rel="stylesheet" href="/.well-known/css/styles/main.css?v=8" type="text/css">
</head>

<body>
  <header>
    <a href=".."><img src="/.well-known/css/images/muenchen.svg" alt="[Solid logo]" /></a>
    <h1>M-Pod Server</h1>
  </header>
  <main>
    <h1>Welcome to Solid</h1>
    <p>
      This server implements
      the <a href="https://solid.github.io/specification/protocol">Solid protocol</a>
      so you can create your own <a href="https://solidproject.org/about">Solid Pod</a>
      and identity.
    </p>

    <h2 id="users">Getting started as a <em>user</em></h2>
    <ul class="actions">
      <li><a id="registration-link" class="button" href="./.account/login/password/register/">Register</a></li>
      <li><a class="button" href="./.account/login/password/">Login</a></li>
    </ul>
    <p id="registration-disabled" class="hidden">
      Registration is disabled on this server.
      Make sure to update the permissions of the root container to prevent other people from modifying your server.
    </p>

</body>
<script>
  (async () => {
    // Since this page is in the root of the server, we can determine other URLs relative to the current URL
    const res = await fetch('.account/');
    const registrationUrl = (await res.json())?.controls?.html?.password?.register;
    // We specifically want to check if the HTML page that we link to exists
    const resRegistrationPage = await fetch(registrationUrl, { headers: { accept: 'text/html' } });
    const registrationEnabled = registrationUrl && resRegistrationPage.status === 200;

    document.getElementById('registration-enabled').classList[registrationEnabled ? 'remove' : 'add']('hidden');
    document.getElementById('registration-disabled').classList[registrationEnabled ? 'add' : 'remove']('hidden');
    document.getElementById('registration-link').href = registrationUrl;
  })();
</script>

</html>