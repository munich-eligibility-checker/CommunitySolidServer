<!DOCTYPE html>
<html lang="de">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="robots" content="noindex">
  <title>M-Pod Server</title>
  <link rel="icon" href="./.well-known/css/images/favicon.ico">
  <link rel="stylesheet" href="./.well-known/css/styles/main.css" type="text/css">
</head>

<body>
  <header>
    <a href=".."><img src="./.well-known/css/images/muenchen.svg" alt="[München Logo]" /></a>
    <h1>M-Pod Server</h1>
  </header>
  <main>
    <h1>Willkommen bei M-Pod</h1>
    <p>
      Dieser Server implementiert das
      <a href="https://solid.github.io/specification/protocol">Solid-Protokoll</a>,
      damit Sie Ihren eigenen <a href="https://solidproject.org/about">Solid Pod</a>
      und Ihre eigene Identität erstellen können.
    </p>

    <h2 id="users">Erste Schritte als <em>Benutzer</em></h2>
    <ul class="actions">
      <li><a id="registration-link" class="button" href="./.account/login/password/register/">Registrieren</a></li>
      <li><a class="button" href="./.account/login/password/">Anmelden</a></li>
    </ul>
  </main>
  <footer>
    <p>Powered by <a href="https://muenchen.de" target="_blank" rel="noopener">muenchen.de</a> &amp; <a href="https://solidproject.org" target="_blank" rel="noopener">Solid</a></p>
  </footer>
</body>

<script>
  (async () => {
    // Since this page is in the root of the server, we can determine other URLs relative to the current URL
    const res = await fetch('.account/');
    const registrationUrl = (await res.json())?.controls?.html?.password?.register;
    // We specifically want to check if the HTML page that we link to exists
    const resRegistrationPage = await fetch(registrationUrl, { headers: { accept: 'text/html' } });
    const registrationEnabled = registrationUrl && resRegistrationPage.status === 200;

    document.getElementById('registration-enabled').classList[registrationEnabled ? 'remove' : 'add']('hidden');
    document.getElementById('registration-disabled').classList[registrationEnabled ? 'add' : 'remove']('hidden');
    document.getElementById('registration-link').href = registrationUrl;
  })();
</script>

</html>